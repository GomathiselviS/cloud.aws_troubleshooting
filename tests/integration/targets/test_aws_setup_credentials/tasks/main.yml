---
- name: Test 'aws_setup_credentials' role
  ansible.builtin.include_role:
    name: cloud.aws_troubleshooting.aws_setup_credentials
  vars:
    aws_profile: default

- name: Ensure credentials contain only aws_profile key
  ansible.builtin.assert:
    that:
      - aws_setup_credentials__output is defined
      - aws_setup_credentials__output.keys() | length == 1
      - '"aws_profile" in aws_setup_credentials__output'
      - aws_setup_credentials__output.aws_profile == 'default'
